<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Work with Custom Distribution Functions • pdqr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<script src="extra.js"></script><meta property="og:title" content="Work with Custom Distribution Functions">
<meta property="og:description" content='Create, transform, and summarize custom random
    variables with distribution functions (analogues of p*(), d*(),
    q*(), and r*() functions from base R). Two types of distributions
    are supported: "discrete" (random variable has finite number of output
    values) and "continuous" (infinite number of values in the form of
    continuous random variable). Functions for distribution
    transformations and summaries are available. Implemented approaches
    often emphasize approximate and numerical solutions: all distributions
    assume finite support and finite values of density function; some
    methods implemented with simulation techniques.'>
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">pdqr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/pdqr-01-create.html">Create pdqr-functions with `new_*()`</a>
    </li>
    <li>
      <a href="articles/pdqr-02-convert.html">Convert pdqr-functions with `as_*()`</a>
    </li>
    <li>
      <a href="articles/pdqr-03-transform.html">Transform pdqr-functions with `form_*()` and base operations</a>
    </li>
    <li>
      <a href="articles/pdqr-04-summarize.html">Summarize pdqr-functions with `summ_*()`</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/echasnovski/pdqr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="pdqr-work-with-custom-distribution-functions" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#pdqr-work-with-custom-distribution-functions" class="anchor"></a>pdqr: Work with Custom Distribution Functions</h1></div>
<!-- badges: start -->

<p>Create, transform, and summarize custom random variables with distribution functions (analogues of <code>p*()</code>, <code>d*()</code>, <code>q*()</code>, and <code>r*()</code> functions from base R), all of which called “pdqr-functions”. General idea is to work with manually created distributions which can be described in four interchangeable functional ways.</p>
<p>Typical usage is to:</p>
<ol>
<li>Create pdqr-function from sample or data frame (with <code>new_*()</code> family), and/or convert from some other existing distribution function (with <code>as_*()</code> family).</li>
<li>Make necessary transformations with <code>form_*()</code> family.</li>
<li>Compute summary values with <code>summ_*()</code> family.</li>
</ol>
<p>Two types of pdqr-functions, representing different types of distributions, are supported:</p>
<ul>
<li>
<strong>Type “discrete”</strong>: random variable has <em>finite number of output values</em>. Pdqr-function is explicitly defined by the collection of its values with their corresponding probability. Usually is used when underlying distribution is discrete (even if in theory there are infinite number of output values).</li>
<li>
<strong>Type “continuous”</strong>: random variable has <em>infinite number of output values in the form of continuous random variable</em>. It is explicitly defined by piecewise-linear density function with finite support and values. Usually is used when underlying distribution is continuous (even if in theory it has infinite support and/or density values).</li>
</ul>
<p>Implemented approaches often emphasize approximate and numerical solutions:</p>
<ul>
<li>All distributions assume <strong>finite support</strong> (output values are bounded from below and above) and <strong>finite values of density function</strong> (density function in case of “continuous” type can’t go to infinity).</li>
<li>Some methods implemented with <strong>simulation techniques</strong>.</li>
</ul>
<p><strong>Note</strong> that to fully use this package, one needs to be familiar with basics of probability theory (concepts such as probability, distribution, density, etc.).</p>
<p>This README covers the following topics:</p>
<ul>
<li>How to install in <a href="#installation">Installation</a>.</li>
<li>How to quickly start using ‘pdqr’ by looking at <a href="#pdqr-quick">Quick examples</a>.</li>
<li>How to create pdqr-function from sample or data frame in <a href="#pdqr-create">Create with <code>new_*()</code></a>.</li>
<li>How to convert existing distribution functions to pdqr-functions in <a href="#pdqr-convert">Convert with <code>as_*()</code></a>.</li>
<li>How to transform distribution in <a href="#pdqr-transform">Transform with <code>form_*()</code></a>.</li>
<li>How to summarize distribution in <a href="#pdqr-summarize">Summarize with <code>summ_*()</code></a>.</li>
<li>What are the other packages with similar functionality in <a href="#similar-packages">Similar packages</a>.</li>
</ul>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>‘pdqr’ is not yet on CRAN. You can install the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"echasnovski/pdqr"</span><span class="op">)</span></code></code></pre></div>
</div>
<div id="-quick-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#-quick-examples" class="anchor"></a><a id="pdqr-quick"></a> Quick examples</h2>
<p>Generate a sample from a distribution defined by some reference sample:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="co"># Treat input sample as coming from a continuous distribution</span>
<span class="va">r_mpg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/new_p.html">new_r</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, type <span class="op">=</span> <span class="st">"continuous"</span><span class="op">)</span>

<span class="fu">r_mpg</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;  [1] 17.3792362 10.4822955 22.8221407 21.8118788 15.5166760 16.3005293 20.5809388 16.8043292 21.1901692</span>
<span class="co">#&gt; [10] 19.9680967</span></code></code></pre></div>
<p>Compute winsorized mean:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="co"># Import 'magrittr' to use pipe operator `%&gt;%`</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>
<span class="co"># Take a sample</span>
<span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span> <span class="op">%&gt;%</span>
  <span class="co"># Create pdqr-function of any class treating input as discrete</span>
  <span class="fu"><a href="reference/new_p.html">new_d</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"discrete"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># Winsorize tails</span>
  <span class="fu"><a href="reference/form_tails.html">form_tails</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.1</span>, method <span class="op">=</span> <span class="st">"winsor"</span>, direction <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># Compute mean of distribution</span>
  <span class="fu"><a href="reference/summ_center.html">summ_mean</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; [1] 20.19375</span></code></code></pre></div>
<p>Compute and visualize distribution of difference of sample means:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="co"># Compute distribution of first sample mean treating input as continuous</span>
<span class="va">mpg_vs0</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span><span class="op">[</span><span class="va">mtcars</span><span class="op">$</span><span class="va">vs</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span>
<span class="va">d_vs0</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/new_p.html">new_d</a></span><span class="op">(</span><span class="va">mpg_vs0</span>, <span class="st">"continuous"</span><span class="op">)</span>
<span class="op">(</span><span class="va">d_vs0_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/form_estimate.html">form_estimate</a></span><span class="op">(</span>
  <span class="va">d_vs0</span>, stat <span class="op">=</span> <span class="va">mean</span>, sample_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">mpg_vs0</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Density function of continuous type</span>
<span class="co">#&gt; Support: ~[12.14822, 20.63362] (511 intervals)</span>

<span class="co"># Compute distribution of second sample mean treating input as continuous</span>
<span class="va">mpg_vs1</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span><span class="op">[</span><span class="va">mtcars</span><span class="op">$</span><span class="va">vs</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span>
<span class="va">d_vs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/new_p.html">new_d</a></span><span class="op">(</span><span class="va">mpg_vs1</span>, <span class="st">"continuous"</span><span class="op">)</span>
<span class="op">(</span><span class="va">d_vs1_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/form_estimate.html">form_estimate</a></span><span class="op">(</span>
  <span class="va">d_vs1</span>, stat <span class="op">=</span> <span class="va">mean</span>, sample_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">mpg_vs1</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Density function of continuous type</span>
<span class="co">#&gt; Support: ~[18.42035, 31.00767] (511 intervals)</span>

<span class="co"># Compute distribution of difference of sample means using random simulation</span>
<span class="op">(</span><span class="va">mpg_diffmean</span> <span class="op">&lt;-</span> <span class="va">d_vs0_mean</span> <span class="op">-</span> <span class="va">d_vs1_mean</span><span class="op">)</span>
<span class="co">#&gt; Density function of continuous type</span>
<span class="co">#&gt; Support: ~[-15.97734, 0.93274] (511 intervals)</span>
<span class="co"># Visualize with base `plot()`</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mpg_diffmean</span>, main <span class="op">=</span> <span class="st">"Distribution of difference of sample means"</span><span class="op">)</span></code></code></pre></div>
<p><img src="reference/figures/README-pdqr-quick_diff-means-1.png"><!-- --></p>
<p>Compute and visualize 95% highest density region for mixture of normal distributions:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="co"># Create a list of pdqr-functions</span>
<span class="va">norm_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  <span class="fu"><a href="reference/as_p.html">as_d</a></span><span class="op">(</span><span class="va">dnorm</span><span class="op">)</span>, <span class="fu"><a href="reference/as_p.html">as_d</a></span><span class="op">(</span><span class="va">dnorm</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>, <span class="fu"><a href="reference/as_p.html">as_d</a></span><span class="op">(</span><span class="va">dnorm</span>, mean <span class="op">=</span> <span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># Form a mixture with custom weights</span>
<span class="va">norm_mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/form_mix.html">form_mix</a></span><span class="op">(</span><span class="va">norm_list</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Compute 95% highest density region</span>
<span class="op">(</span><span class="va">norm_hdr</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/summ_hdr.html">summ_hdr</a></span><span class="op">(</span><span class="va">norm_mix</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;          left      right</span>
<span class="co">#&gt; 1 -1.82442072 2.53095750</span>
<span class="co">#&gt; 2  3.19649819 4.79334429</span>

<span class="co"># Visualize</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">norm_mix</span>, main <span class="op">=</span> <span class="st">"95% highest density region for normal mixture"</span><span class="op">)</span>
<span class="fu"><a href="reference/region.html">region_draw</a></span><span class="op">(</span><span class="va">norm_hdr</span><span class="op">)</span></code></code></pre></div>
<p><img src="reference/figures/README-pdqr-quick_mixture-hdr-1.png"><!-- --></p>
</div>
<div id="-create-with-new_" class="section level2">
<h2 class="hasAnchor">
<a href="#-create-with-new_" class="anchor"></a><a id="pdqr-create"></a> Create with <code>new_*()</code>
</h2>
<p>All <code>new_*()</code> functions create a pdqr-function of certain class (“p”, “d”, “q”, or “r”) and type (“discrete” or “continuous”) based on sample or data frame (with appropriate structure):</p>
<ul>
<li>
<strong>Sample input</strong> is converted into data frame of appropriate structure that defines distribution (see next list item). It is done based on type. For “discrete” type it gets tabulated with frequency of unique values serving as their probability. For “continuous” type distribution density is estimated using <a href="https://rdrr.io/r/stats/density.html"><code>density()</code></a> function if input has at least 2 elements. For 1 element special “dirac-like” pdqr-function is created: an <em>approximation of single number</em> as triangular distribution with very narrow support (1e-8 order of magnitude).</li>
<li>
<strong>Data frame input</strong> should completely define distribution. For “discrete” type it should have “x” and “prob” columns for output values and their probabilities. For “continuous” type - “x” and “y” columns for points, which define piecewise-linear continuous density function. Columns “prob” and “y” will be automatically normalized to represent proper distribution: sum of “prob” will be 1 and total square under graph of piecewise-linear function will be 1.</li>
</ul>
<p>All information about distribution that pdqr-function represents is stored in its <strong>“x_tbl” metadata</strong>: a data frame describing distribution with format similar to data frame input of <code>new_*()</code> functions. One can get it using <code><a href="reference/meta.html">meta_x_tbl()</a></code> function.</p>
<p>Pdqr class correspond to the following functions describing distribution:</p>
<ul>
<li>
<strong>P-function</strong> is a cumulative distribution function. Created with <code><a href="reference/new_p.html">new_p()</a></code>.</li>
<li>
<strong>D-function</strong> is a probability mass function for “discrete” type and density function for “continuous”. Created with <code><a href="reference/new_p.html">new_d()</a></code>. Generally speaking, it is a derivative of distribution’s p-function.</li>
<li>
<strong>Q-function</strong> is a quantile function. Created with <code><a href="reference/new_p.html">new_q()</a></code>. Inverse of distribution’s p-function.</li>
<li>
<strong>R-function</strong> is a random generation function. Created with <code><a href="reference/new_p.html">new_r()</a></code>. Generates a random sample from distribution.</li>
</ul>
<p>For more details see <a href="https://echasnovski.github.io/pdqr/articles/pdqr-01-create.html">vignette about creating pdqr-functions</a>.</p>
<div id="create-pdqr-function-from-sample" class="section level3">
<h3 class="hasAnchor">
<a href="#create-pdqr-function-from-sample" class="anchor"></a>Create pdqr-function from sample</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="co"># Treat input as discrete</span>
<span class="op">(</span><span class="va">p_mpg_dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/new_p.html">new_p</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, type <span class="op">=</span> <span class="st">"discrete"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Cumulative distribution function of discrete type</span>
<span class="co">#&gt; Support: [10.4, 33.9] (25 elements)</span>
<span class="op">(</span><span class="va">d_mpg_dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/new_p.html">new_d</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, type <span class="op">=</span> <span class="st">"discrete"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Probability mass function of discrete type</span>
<span class="co">#&gt; Support: [10.4, 33.9] (25 elements)</span>
<span class="op">(</span><span class="va">q_mpg_dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/new_p.html">new_q</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, type <span class="op">=</span> <span class="st">"discrete"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Quantile function of discrete type</span>
<span class="co">#&gt; Support: [10.4, 33.9] (25 elements)</span>
<span class="op">(</span><span class="va">r_mpg_dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/new_p.html">new_r</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, type <span class="op">=</span> <span class="st">"discrete"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Random generation function of discrete type</span>
<span class="co">#&gt; Support: [10.4, 33.9] (25 elements)</span>

<span class="co">## "x_tbl" metadata is the same for all `*_mpg_dis()` pdqr-functions</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="reference/meta.html">meta_x_tbl</a></span><span class="op">(</span><span class="va">p_mpg_dis</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;      x    prob cumprob</span>
<span class="co">#&gt; 1 10.4 0.06250 0.06250</span>
<span class="co">#&gt; 2 13.3 0.03125 0.09375</span>
<span class="co">#&gt; 3 14.3 0.03125 0.12500</span>

<span class="co"># Treat input as continuous</span>
<span class="op">(</span><span class="va">p_mpg_con</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/new_p.html">new_p</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, type <span class="op">=</span> <span class="st">"continuous"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Cumulative distribution function of continuous type</span>
<span class="co">#&gt; Support: ~[2.96996, 41.33004] (511 intervals)</span>
<span class="op">(</span><span class="va">d_mpg_con</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/new_p.html">new_d</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, type <span class="op">=</span> <span class="st">"continuous"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Density function of continuous type</span>
<span class="co">#&gt; Support: ~[2.96996, 41.33004] (511 intervals)</span>
<span class="op">(</span><span class="va">q_mpg_con</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/new_p.html">new_q</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, type <span class="op">=</span> <span class="st">"continuous"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Quantile function of continuous type</span>
<span class="co">#&gt; Support: ~[2.96996, 41.33004] (511 intervals)</span>
<span class="op">(</span><span class="va">r_mpg_con</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/new_p.html">new_r</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, type <span class="op">=</span> <span class="st">"continuous"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Random generation function of continuous type</span>
<span class="co">#&gt; Support: ~[2.96996, 41.33004] (511 intervals)</span>

<span class="co">## "x_tbl" metadata is the same for all `*_mpg_con()` pdqr-functions</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="reference/meta.html">meta_x_tbl</a></span><span class="op">(</span><span class="va">p_mpg_con</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;            x              y        cumprob</span>
<span class="co">#&gt; 1 2.96996269 0.000114133557 0.00000000e+00</span>
<span class="co">#&gt; 2 3.04503133 0.000125168087 8.98202438e-06</span>
<span class="co">#&gt; 3 3.12009996 0.000136934574 1.88198694e-05</span>

<span class="co"># Output of `new_*()` is actually a function</span>
<span class="fu">p_mpg_dis</span><span class="op">(</span><span class="fl">15</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.18750 0.31250 0.34375 0.40625 0.46875 0.56250</span>

<span class="co">## Random generation. "discrete" type generates only values from input</span>
<span class="fu">r_mpg_dis</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;  [1] 10.4 33.9 26.0 19.2 24.4 18.7 17.8 18.7 15.5 21.4</span>
<span class="fu">r_mpg_con</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;  [1] 35.7089680 33.3634914 31.1541225 15.6482281 20.8554689 13.7275908 11.3686051 16.7155604 20.6710197</span>
<span class="co">#&gt; [10] 20.5132727</span>

<span class="co"># Special case of dirac-like pdqr-function, which numerically approximates</span>
<span class="co"># single number with distribution with narrow support</span>
<span class="op">(</span><span class="va">r_dirac</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/new_p.html">new_r</a></span><span class="op">(</span><span class="fl">3.14</span>, <span class="st">"continuous"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Random generation function of continuous type</span>
<span class="co">#&gt; Support: ~[3.14, 3.14] (2 intervals)</span>
<span class="fu"><a href="reference/meta.html">meta_x_tbl</a></span><span class="op">(</span><span class="va">r_dirac</span><span class="op">)</span>
<span class="co">#&gt;            x         y cumprob</span>
<span class="co">#&gt; 1 3.13999999         0     0.0</span>
<span class="co">#&gt; 2 3.14000000 100000001     0.5</span>
<span class="co">#&gt; 3 3.14000001         0     1.0</span></code></code></pre></div>
</div>
<div id="create-pdqr-function-from-data-frame" class="section level3">
<h3 class="hasAnchor">
<a href="#create-pdqr-function-from-data-frame" class="anchor"></a>Create pdqr-function from data frame</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="co"># Type "discrete"</span>
<span class="va">dis_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, prob <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="reference/new_p.html">new_d</a></span><span class="op">(</span><span class="va">dis_tbl</span>, type <span class="op">=</span> <span class="st">"discrete"</span><span class="op">)</span>
<span class="co">#&gt; Probability mass function of discrete type</span>
<span class="co">#&gt; Support: [1, 4] (4 elements)</span>
<span class="fu"><a href="reference/new_p.html">new_r</a></span><span class="op">(</span><span class="va">dis_tbl</span>, type <span class="op">=</span> <span class="st">"discrete"</span><span class="op">)</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;  [1] 4 1 3 1 2 4 3 2 4 1</span>

<span class="co"># Type "continuous"</span>
<span class="va">con_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="reference/new_p.html">new_d</a></span><span class="op">(</span><span class="va">con_tbl</span>, type <span class="op">=</span> <span class="st">"continuous"</span><span class="op">)</span>
<span class="co">#&gt; Density function of continuous type</span>
<span class="co">#&gt; Support: [1, 4] (3 intervals)</span>
<span class="fu"><a href="reference/new_p.html">new_r</a></span><span class="op">(</span><span class="va">con_tbl</span>, type <span class="op">=</span> <span class="st">"continuous"</span><span class="op">)</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;  [1] 2.21323986 1.58190910 2.85635049 2.32440194 2.44538842 2.89743821 3.29852362 2.43084969 2.81580878</span>
<span class="co">#&gt; [10] 2.79585280</span></code></code></pre></div>
</div>
</div>
<div id="-convert-with-as_" class="section level2">
<h2 class="hasAnchor">
<a href="#-convert-with-as_" class="anchor"></a><a id="pdqr-convert"></a> Convert with <code>as_*()</code>
</h2>
<p>Family of <code>as_*()</code> functions should be used to convert existing distribution functions into desired class (“p”, “d”, “q”, or “r”). Roughly, this is a <code>new_*()</code> family but with function as an input.</p>
<p>There are two main use cases:</p>
<ul>
<li>Convert existing pdqr-functions to different type.</li>
<li>Convert (create) pdqr-function based on some other user-supplied distribution function.</li>
</ul>
<p>For more details see <a href="https://echasnovski.github.io/pdqr/articles/pdqr-02-convert.html">vignette about converting pdqr-functions</a>.</p>
<div id="existing-pdqr-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#existing-pdqr-functions" class="anchor"></a>Existing pdqr-functions</h3>
<p>Converting existing pdqr-function to desired type is done straightforwardly by changing function’s class without touching the underlying distribution (“x_tbl” metadata is the same):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="va">d_dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/new_p.html">new_d</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="st">"discrete"</span><span class="op">)</span>
<span class="fu"><a href="reference/meta.html">meta_x_tbl</a></span><span class="op">(</span><span class="va">d_dis</span><span class="op">)</span>
<span class="co">#&gt;   x prob cumprob</span>
<span class="co">#&gt; 1 1 0.25    0.25</span>
<span class="co">#&gt; 2 2 0.25    0.50</span>
<span class="co">#&gt; 3 3 0.25    0.75</span>
<span class="co">#&gt; 4 4 0.25    1.00</span>

<span class="co"># This is equivalent to `new_p(1:4, "discrete")`</span>
<span class="op">(</span><span class="va">p_dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_p.html">as_p</a></span><span class="op">(</span><span class="va">d_dis</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Cumulative distribution function of discrete type</span>
<span class="co">#&gt; Support: [1, 4] (4 elements)</span>
<span class="fu"><a href="reference/meta.html">meta_x_tbl</a></span><span class="op">(</span><span class="va">p_dis</span><span class="op">)</span>
<span class="co">#&gt;   x prob cumprob</span>
<span class="co">#&gt; 1 1 0.25    0.25</span>
<span class="co">#&gt; 2 2 0.25    0.50</span>
<span class="co">#&gt; 3 3 0.25    0.75</span>
<span class="co">#&gt; 4 4 0.25    1.00</span></code></code></pre></div>
</div>
<div id="other-distribution-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#other-distribution-functions" class="anchor"></a>Other distribution functions</h3>
<p>Another important use case for <code>as_*()</code> functions is to convert some other distribution functions to be pdqr-functions. Except small number of special cases, output of <code>as_*()</code> function will have “continuous” type. The reason is because identifying exact values of distribution in discrete case is very hard in this setup (when almost nothing is known about the input function). It is assumed that if user knows those values, some <code>new_*()</code> function with data frame input can be used to create arbitrary discrete pdqr-function.</p>
<p>General conversion algorithm is as follows:</p>
<ul>
<li>If user didn’t supply support, detect it using algorithms targeted for every pdqr class separately. If <em>input function belongs to a certain set of “honored” distributions</em> (currently, it is all common univariate distributions <a href="https://rdrr.io/r/stats/Distributions.html">from ‘stats’ package</a>), support is detected in predefined way.</li>
<li>Using detected support, data frame input for corresponding <code>new_*()</code> function is created which approximates input function. Approximation precision can be tweaked with <code>n_grid</code> (and <code>n_sample</code> for <code><a href="reference/as_p.html">as_r()</a></code>) argument.</li>
</ul>
<p><strong>Note</strong> that output is usually an approximation of input due to the following facts:</p>
<ul>
<li>Output density has piecewise-linear nature, which is almost never the case for input function.</li>
<li>Possible infinite tails are removed to obtain finite support. Usually output support “loses” only around 1e-6 probability on each infinite tail.</li>
<li>Possible infinite values of density are linearly approximated from neighborhood points.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="co"># "Honored" distributions</span>
<span class="fu"><a href="reference/as_p.html">as_d</a></span><span class="op">(</span><span class="va">dnorm</span><span class="op">)</span>
<span class="co">#&gt; Density function of continuous type</span>
<span class="co">#&gt; Support: ~[-4.75342, 4.75342] (10000 intervals)</span>

<span class="co">## Different picewise-linear approximation precision</span>
<span class="fu"><a href="reference/as_p.html">as_d</a></span><span class="op">(</span><span class="va">dnorm</span>, n_grid <span class="op">=</span> <span class="fl">101</span><span class="op">)</span>
<span class="co">#&gt; Density function of continuous type</span>
<span class="co">#&gt; Support: ~[-4.75342, 4.75342] (100 intervals)</span>

<span class="co">## Different extra arguments for input</span>
<span class="fu"><a href="reference/as_p.html">as_d</a></span><span class="op">(</span><span class="va">dnorm</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="co">#&gt; Density function of continuous type</span>
<span class="co">#&gt; Support: ~[9.52466, 10.47534] (10000 intervals)</span>

<span class="co"># Custom functions</span>
<span class="va">my_d</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;=</span> <span class="fl">1</span>, <span class="fl">0.75</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>
<span class="op">}</span>
<span class="co">## With algorithmic support detection</span>
<span class="fu"><a href="reference/as_p.html">as_d</a></span><span class="op">(</span><span class="va">my_d</span><span class="op">)</span>
<span class="co">#&gt; Density function of continuous type</span>
<span class="co">#&gt; Support: ~[-1.00018, 1.00019] (7588 intervals)</span>

<span class="co">## Providing custom, maybe only partially known, support</span>
<span class="fu"><a href="reference/as_p.html">as_d</a></span><span class="op">(</span><span class="va">my_d</span>, support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Density function of continuous type</span>
<span class="co">#&gt; Support: ~[-1, 1.00007] (9327 intervals)</span>
<span class="fu"><a href="reference/as_p.html">as_d</a></span><span class="op">(</span><span class="va">my_d</span>, support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Density function of continuous type</span>
<span class="co">#&gt; Support: [-1, 1] (10000 intervals)</span></code></code></pre></div>
</div>
</div>
<div id="-transform-with-form_-and-base-operations" class="section level2">
<h2 class="hasAnchor">
<a href="#-transform-with-form_-and-base-operations" class="anchor"></a><a id="pdqr-transform"></a> Transform with <code>form_*()</code> and base operations</h2>
<p>Concept of form functions is to take one or more pdqr-function(s) and return a transformed pdqr-function. Argument <code>method</code> is used to choose function-specific algorithm of computation.</p>
<p>For more details see <a href="https://echasnovski.github.io/pdqr/articles/pdqr-03-transform.html">vignette about transforming pdqr-functions</a>.</p>
<div id="form_-family" class="section level3">
<h3 class="hasAnchor">
<a href="#form_-family" class="anchor"></a><code>form_*()</code> family</h3>
<p>There are several <code>form_*()</code> functions. Here are some examples:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="co"># Transform support of pdqr-function with `form_resupport()`. Usually useful</span>
<span class="co"># for dealing with bounded values.</span>
<span class="va">d_smpl</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/new_p.html">new_d</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"continuous"</span><span class="op">)</span>
<span class="va">d_smpl_bounded</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/form_resupport.html">form_resupport</a></span><span class="op">(</span><span class="va">d_smpl</span>, support <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"reflect"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">d_smpl</span>, main <span class="op">=</span> <span class="st">"Estimating density of bounded quantity"</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">d_smpl_bounded</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>
<span class="co">## Reference uniform distribution</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="reference/as_p.html">as_d</a></span><span class="op">(</span><span class="va">dunif</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></code></pre></div>
<p><img src="reference/figures/README-pdqr-transform_form-1.png"><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="co"># Perform general transformation with `form_trans()`. This is usually done by</span>
<span class="co"># randomly simulating sample from output distribution and then calling one of</span>
<span class="co"># `new_*()` functions.</span>
<span class="va">d_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_p.html">as_d</a></span><span class="op">(</span><span class="va">dnorm</span><span class="op">)</span>
<span class="co">## More accurate result would give use of `+` directly with: d_norm + d_norm</span>
<span class="va">d_norm_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/form_trans.html">form_trans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">d_norm</span>, <span class="va">d_norm</span><span class="op">)</span>, trans <span class="op">=</span> <span class="va">`+`</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">d_norm_2</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="reference/as_p.html">as_d</a></span><span class="op">(</span><span class="va">dnorm</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></code></pre></div>
<p><img src="reference/figures/README-pdqr-transform_form-2.png"><!-- --></p>
</div>
<div id="base-operations" class="section level3">
<h3 class="hasAnchor">
<a href="#base-operations" class="anchor"></a>Base operations</h3>
<p>Almost all basic R operations (implemented with <a href="https://rdrr.io/r/base/groupGeneric.html">S3 group generic functions</a>) has methods for pdqr-functions. Operations are done as if applied to independent random variables with distributions represented by input pdqr-function(s). Many of methods have random nature and are implemented with <code><a href="reference/form_trans.html">form_trans()</a></code>, but have little tweaks that make their direct usage better than <code><a href="reference/form_trans.html">form_trans()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="va">d_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_p.html">as_d</a></span><span class="op">(</span><span class="va">dnorm</span><span class="op">)</span>
<span class="va">d_unif</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_p.html">as_d</a></span><span class="op">(</span><span class="va">dunif</span><span class="op">)</span>

<span class="co"># Distribution of difference of random variables. Computed with random</span>
<span class="co"># simulation.</span>
<span class="va">d_norm</span> <span class="op">-</span> <span class="va">d_unif</span>
<span class="co">#&gt; Density function of continuous type</span>
<span class="co">#&gt; Support: ~[-5.02445, 3.65236] (511 intervals)</span>

<span class="co"># Comparing random variables results into boolean random variable represented</span>
<span class="co"># by boolean pdqr-function (type "discrete" with values 0 for FALSE and 1 for</span>
<span class="co"># TRUE). Here it means that random value of `d_norm` will be greater than random</span>
<span class="co"># value of `d_unif` with probability around 0.316. This is computed directly,</span>
<span class="co"># without random simulation.</span>
<span class="va">d_norm</span> <span class="op">&gt;</span> <span class="va">d_unif</span>
<span class="co">#&gt; Probability mass function of discrete type</span>
<span class="co">#&gt; Support: [0, 1] (2 elements, probability of 1: ~0.31563)</span>

<span class="co"># Distribution of maximum of three random variables. Computed with random</span>
<span class="co"># simulation.</span>
<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">d_norm</span>, <span class="va">d_norm</span>, <span class="va">d_norm</span><span class="op">)</span>
<span class="co">#&gt; Density function of continuous type</span>
<span class="co">#&gt; Support: ~[-2.3575, 4.11583] (511 intervals)</span></code></code></pre></div>
</div>
</div>
<div id="-summarize-with-summ_" class="section level2">
<h2 class="hasAnchor">
<a href="#-summarize-with-summ_" class="anchor"></a><a id="pdqr-summarize"></a> Summarize with <code>summ_*()</code>
</h2>
<p>Concept of summary functions is to take one or more pdqr-function(s) and return a summary value. Argument <code>method</code> is used to choose function-specific algorithm of computation.</p>
<p>For more details see <a href="https://echasnovski.github.io/pdqr/articles/pdqr-04-summarize.html">vignette about summarizing pdqr-functions</a>.</p>
<div id="basic-summary" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-summary" class="anchor"></a>Basic summary</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="va">my_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_p.html">as_d</a></span><span class="op">(</span><span class="va">dbeta</span>, shape1 <span class="op">=</span> <span class="fl">1</span>, shape2 <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>

<span class="co"># There are wrappers for all center summaries</span>
<span class="fu"><a href="reference/summ_center.html">summ_center</a></span><span class="op">(</span><span class="va">my_d</span>, method <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.249999259</span>
<span class="fu"><a href="reference/summ_center.html">summ_center</a></span><span class="op">(</span><span class="va">my_d</span>, method <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.20629921</span>
<span class="fu"><a href="reference/summ_center.html">summ_center</a></span><span class="op">(</span><span class="va">my_d</span>, method <span class="op">=</span> <span class="st">"mode"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0</span>

<span class="co"># There are wrappers for spread summaries</span>
<span class="fu"><a href="reference/summ_spread.html">summ_spread</a></span><span class="op">(</span><span class="va">my_d</span>, method <span class="op">=</span> <span class="st">"sd"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.193647842</span>

<span class="co"># These return essentially the same result</span>
<span class="fu"><a href="reference/summ_moment.html">summ_moment</a></span><span class="op">(</span><span class="va">my_d</span>, order <span class="op">=</span> <span class="fl">2</span>, central <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.0374994867</span>
<span class="fu"><a href="reference/summ_spread.html">summ_spread</a></span><span class="op">(</span><span class="va">my_d</span>, method <span class="op">=</span> <span class="st">"var"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.0374994867</span></code></code></pre></div>
</div>
<div id="regions" class="section level3">
<h3 class="hasAnchor">
<a href="#regions" class="anchor"></a>Regions</h3>
<p>Distributions can be summarized with regions: union of closed intervals. They are represented as data frame with rows representing intervals and two columns “left” and “right” with left and right interval edges respectively.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="co"># 90% highest density region (HDR)</span>
<span class="fu"><a href="reference/summ_hdr.html">summ_hdr</a></span><span class="op">(</span><span class="va">my_d</span>, level <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span>
<span class="co">#&gt;   left    right</span>
<span class="co">#&gt; 1    0 0.535887</span>

<span class="co">## In case of unimodal distribution HDR is essentially the same as 90% interval</span>
<span class="co">## of minimum width</span>
<span class="fu"><a href="reference/summ_interval.html">summ_interval</a></span><span class="op">(</span><span class="va">my_d</span>, level <span class="op">=</span> <span class="fl">0.9</span>, method <span class="op">=</span> <span class="st">"minwidth"</span><span class="op">)</span>
<span class="co">#&gt;   left       right</span>
<span class="co">#&gt; 1    0 0.535839727</span>

<span class="fu"><a href="reference/summ_interval.html">summ_interval</a></span><span class="op">(</span><span class="va">my_d</span>, level <span class="op">=</span> <span class="fl">0.9</span>, method <span class="op">=</span> <span class="st">"percentile"</span><span class="op">)</span>
<span class="co">#&gt;           left       right</span>
<span class="co">#&gt; 1 0.0169524103 0.631594521</span></code></code></pre></div>
</div>
<div id="distance" class="section level3">
<h3 class="hasAnchor">
<a href="#distance" class="anchor"></a>Distance</h3>
<p>Function <code><a href="reference/summ_distance.html">summ_distance()</a></code> takes two pdqr-functions and returns a distance between two distributions they represent. Many methods of computation are available. This might be useful for doing comparative statistical inference.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="va">my_d_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/as_p.html">as_d</a></span><span class="op">(</span><span class="va">dnorm</span>, mean <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>

<span class="co"># Kolmogorov-Smirnov distance</span>
<span class="fu"><a href="reference/summ_distance.html">summ_distance</a></span><span class="op">(</span><span class="va">my_d</span>, <span class="va">my_d_2</span>, method <span class="op">=</span> <span class="st">"KS"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.397684098</span>

<span class="co"># Total variation distance</span>
<span class="fu"><a href="reference/summ_distance.html">summ_distance</a></span><span class="op">(</span><span class="va">my_d</span>, <span class="va">my_d_2</span>, method <span class="op">=</span> <span class="st">"totvar"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.706221267</span>

<span class="co"># Probability of one distribution be bigger than the other, normalized to [0;1]</span>
<span class="fu"><a href="reference/summ_distance.html">summ_distance</a></span><span class="op">(</span><span class="va">my_d</span>, <span class="va">my_d_2</span>, method <span class="op">=</span> <span class="st">"compare"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.194615851</span>

<span class="co"># Wassertein distance: "average path density point should go while transforming</span>
<span class="co"># from one into another"</span>
<span class="fu"><a href="reference/summ_distance.html">summ_distance</a></span><span class="op">(</span><span class="va">my_d</span>, <span class="va">my_d_2</span>, method <span class="op">=</span> <span class="st">"wass"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.685534883</span>

<span class="co"># Cramer distance: integral of squared difference of p-functions</span>
<span class="fu"><a href="reference/summ_distance.html">summ_distance</a></span><span class="op">(</span><span class="va">my_d</span>, <span class="va">my_d_2</span>, method <span class="op">=</span> <span class="st">"cramer"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.165921075</span>

<span class="co"># "Align" distance: path length for which one of distribution should be "moved"</span>
<span class="co"># towards the other so that they become "aligned" (probability of one being</span>
<span class="co"># greater than the other is 0.5)</span>
<span class="fu"><a href="reference/summ_distance.html">summ_distance</a></span><span class="op">(</span><span class="va">my_d</span>, <span class="va">my_d_2</span>, method <span class="op">=</span> <span class="st">"align"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.251020429</span>

<span class="co"># "Entropy" distance: `KL(f, g) + KL(g, f)`, where `KL()` is Kullback-Leibler</span>
<span class="co"># divergence. Usually should be used for distributions with same support, but</span>
<span class="co"># works even if they are different (with big numerical penalty).</span>
<span class="fu"><a href="reference/summ_distance.html">summ_distance</a></span><span class="op">(</span><span class="va">my_d</span>, <span class="va">my_d_2</span>, method <span class="op">=</span> <span class="st">"entropy"</span><span class="op">)</span>
<span class="co">#&gt; [1] 12.6930974</span></code></code></pre></div>
</div>
<div id="separation-classification-and-roc-curve" class="section level3">
<h3 class="hasAnchor">
<a href="#separation-classification-and-roc-curve" class="anchor"></a>Separation, classification, and ROC curve</h3>
<p>Function <code><a href="reference/summ_separation.html">summ_separation()</a></code> computes a threshold that optimally separates distributions represented by pair of input pdqr-functions. In other words, <code><a href="reference/summ_separation.html">summ_separation()</a></code> solves a binary classification problem with one-dimensional linear classifier: values not more than some threshold are classified as one class, and more than threshold - as another. Order of input functions doesn’t matter.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="fu"><a href="reference/summ_separation.html">summ_separation</a></span><span class="op">(</span><span class="va">my_d</span>, <span class="va">my_d_2</span>, method <span class="op">=</span> <span class="st">"KS"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.637042714</span>
<span class="fu"><a href="reference/summ_separation.html">summ_separation</a></span><span class="op">(</span><span class="va">my_d</span>, <span class="va">my_d_2</span>, method <span class="op">=</span> <span class="st">"F1"</span><span class="op">)</span>
<span class="co">#&gt; [1] -6.02372908e-05</span></code></code></pre></div>
<p>Functions <code><a href="reference/summ_classmetric.html">summ_classmetric()</a></code> and <code><a href="reference/summ_classmetric.html">summ_classmetric_df()</a></code> compute metric of classification setup, similar to one used in <code><a href="reference/summ_separation.html">summ_separation()</a></code>. Here classifier threshold should be supplied and order of input matters. Classification is assumed to be done as follows: any x value not more than threshold value is classified as “negative”; if strictly greater - “positive”. Classification metrics are computed based on two pdqr-functions: <code>f</code>, which represents the distribution of values which should be classified as “negative” (“true negative”), and <code>g</code> - the same for “positive” (“true positive”).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="co"># Many threshold values can be supplied</span>
<span class="va">thres_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>
<span class="fu"><a href="reference/summ_classmetric.html">summ_classmetric</a></span><span class="op">(</span>f <span class="op">=</span> <span class="va">my_d</span>, g <span class="op">=</span> <span class="va">my_d_2</span>, threshold <span class="op">=</span> <span class="va">thres_vec</span>, method <span class="op">=</span> <span class="st">"F1"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.513819342 0.580222932 0.614898704 0.603832562 0.549732861 0.471575705</span>

<span class="co"># In `summ_classmetric_df()` many methods can be supplied</span>
<span class="fu"><a href="reference/summ_classmetric.html">summ_classmetric_df</a></span><span class="op">(</span>
  f <span class="op">=</span> <span class="va">my_d</span>, g <span class="op">=</span> <span class="va">my_d_2</span>, threshold <span class="op">=</span> <span class="va">thres_vec</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GM"</span>, <span class="st">"F1"</span>, <span class="st">"MCC"</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt;   threshold          GM          F1          MCC</span>
<span class="co">#&gt; 1       0.0 0.000000000 0.513819342 -0.427093061</span>
<span class="co">#&gt; 2       0.2 0.549127659 0.580222932  0.106817345</span>
<span class="co">#&gt; 3       0.4 0.650557843 0.614898704  0.333936376</span>
<span class="co">#&gt; 4       0.6 0.656293762 0.603832562  0.450433146</span>
<span class="co">#&gt; 5       0.8 0.615655766 0.549732861  0.472055694</span>
<span class="co">#&gt; 6       1.0 0.555461222 0.471575705  0.427093061</span></code></code></pre></div>
<p>With <code><a href="reference/summ_roc.html">summ_roc()</a></code> and <code><a href="reference/summ_roc.html">summ_rocauc()</a></code> one can compute data frame of ROC curve points and ROC AUC value respectively. There is also a <code><a href="reference/summ_roc.html">roc_plot()</a></code> function for predefined plotting of ROC curve.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r"><code class = "r">
<code class="sourceCode R"><span class="va">my_roc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/summ_roc.html">summ_roc</a></span><span class="op">(</span><span class="va">my_d</span>, <span class="va">my_d_2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">my_roc</span><span class="op">)</span>
<span class="co">#&gt;    threshold fpr            tpr</span>
<span class="co">#&gt; 1 5.25342531   0 0.00000000e+00</span>
<span class="co">#&gt; 2 5.24391846   0 4.81164585e-08</span>
<span class="co">#&gt; 3 5.23441161   0 9.84577933e-08</span>
<span class="co">#&gt; 4 5.22490476   0 1.51116706e-07</span>
<span class="co">#&gt; 5 5.21539791   0 2.06194913e-07</span>
<span class="co">#&gt; 6 5.20589106   0 2.63798357e-07</span>
<span class="fu"><a href="reference/summ_roc.html">summ_rocauc</a></span><span class="op">(</span><span class="va">my_d</span>, <span class="va">my_d_2</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.597307926</span>
<span class="fu"><a href="reference/summ_roc.html">roc_plot</a></span><span class="op">(</span><span class="va">my_roc</span><span class="op">)</span></code></code></pre></div>
<p><img src="reference/figures/README-pdqr-summarize_roc-1.png"><!-- --></p>
</div>
</div>
<div id="-similar-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#-similar-packages" class="anchor"></a><a id="similar-packages"></a> Similar packages</h2>
<ul>
<li>
<a href="http://distr.r-forge.r-project.org/">“distrXXX”-family</a> of packages: S4 classes for distributions.</li>
<li>
<a href="https://alan-turing-institute.github.io/distr6/">distr6</a>: Unified and Object Oriented Probability Distribution Interface for R written in R6.</li>
<li>
<a href="https://alexpghayes.github.io/distributions3/">distributions3</a>: Probability Distributions as S3 Objects.</li>
<li>
<a href="https://CRAN.R-project.org/package=fitdistrplus">fitdistrplus</a>: Help to Fit of a Parametric Distribution to Non-Censored or Censored Data.</li>
<li>
<a href="https://CRAN.R-project.org/view=Distributions">Probability Distributions</a> CRAN Task View has more examples of packages intended to work with probability distributions.</li>
<li>
<a href="https://CRAN.R-project.org/package=hdrcde">hdrcde</a>: Highest Density Regions and Conditional Density Estimation.</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=pdqr">https://​cloud.r-project.org/​package=pdqr</a>
</li>
<li>Browse source code at <br><a href="https://github.com/echasnovski/pdqr/">https://​github.com/​echasnovski/​pdqr/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/echasnovski/pdqr/issues">https://​github.com/​echasnovski/​pdqr/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Evgeni Chasnovski <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-1617-4019" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/echasnovski/pdqr/actions"><img src="https://github.com/echasnovski/pdqr/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://codecov.io/github/echasnovski/pdqr?branch=master"><img src="https://codecov.io/gh/echasnovski/pdqr/branch/master/graph/badge.svg" alt="Coverage status"></a></li>
<li><a href="https://cran.r-project.org/package=pdqr"><img src="https://www.r-pkg.org/badges/version/pdqr?color=blue" alt="CRAN"></a></li>
<li><a href="https://CRAN.R-project.org/package=pdqr"><img src="https://tinyverse.netlify.com/badge/pdqr" alt="Dependencies"></a></li>
<li><a href="https://cran.r-project.org/package=pdqr"><img src="http://cranlogs.r-pkg.org/badges/pdqr" alt="Downloads"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Evgeni Chasnovski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
