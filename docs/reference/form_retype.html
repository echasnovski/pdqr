<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Change type of pdqr-function — form_retype • pdqr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  <script src="../extra.js"></script>

<meta property="og:title" content="Change type of pdqr-function — form_retype" />
<meta property="og:description" content="Modify type of pdqr-function using method of choice." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pdqr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/pdqr-01-create.html">Create pdqr-functions with `new_*()`</a>
    </li>
    <li>
      <a href="../articles/pdqr-02-convert.html">Convert pdqr-functions with `as_*()`</a>
    </li>
    <li>
      <a href="../articles/pdqr-03-transform.html">Transform pdqr-functions with `form_*()` and base operations</a>
    </li>
    <li>
      <a href="../articles/pdqr-04-summarize.html">Summarize pdqr-functions with `summ_*()`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/echasnovski/pdqr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Change type of pdqr-function</h1>
    <small class="dont-index">Source: <a href='https://github.com/echasnovski/pdqr/blob/master/R/form_retype.R'><code>R/form_retype.R</code></a></small>
    <div class="hidden name"><code>form_retype.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Modify <a href='meta.html'>type</a> of pdqr-function using method of choice.</p>
    </div>

    <pre class="usage"><code class = "r"><span class='fu'>form_retype</span><span class='op'>(</span><span class='va'>f</span>, type <span class='op'>=</span> <span class='cn'>NULL</span>, method <span class='op'>=</span> <span class='st'>"value"</span><span class='op'>)</span></code></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>f</th>
      <td><p>A pdqr-function.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>A desired type of output. Should be one of "discrete" or
"continuous". If <code>NULL</code> (default), it is chosen as an opposite of <code>f</code>'s
type.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Retyping method. Should be one of "value", "piecelin", "dirac".</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A pdqr-function with type equal to input <code>type</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If type of <code>f</code> is equal to input <code>type</code> then <code>f</code> is returned.</p>
<p>Method "value" uses renormalized columns of <code>f</code>'s "x_tbl" metadata as values
for output's "x_tbl" metadata. In other words, it preserves ratios between
values of d-function at certain "x" points. Its main advantages are that this
method can work well with any pdqr type and that two consecutive conversions
return the same function. Conversion algorithm is as follows:</p><ul>
<li><p>Retyping from "continuous" to <code>type</code> "discrete" is done by creating
pdqr-function of corresponding class with the following "x_tbl" metadata: "x"
column is the same as in <code>f</code>; "prob" column is equal to <code>f</code>'s "y" column
after renormalization (so that their sum is 1).</p></li>
<li><p>Retyping from "discrete" to <code>type</code> "continuous" is done in the same
fashion: "x" column is the same; "y" column is equal to <code>f</code>'s "prob" column
after renormalization (so that total integral of piecewise-linear density is
equal to 1).</p></li>
</ul>

<p>Method "piecelin" should be used mostly for converting from "continuous" to
"discrete" type. It uses the fact that 'pdqr' densities are piecewise-linear
(linear in intervals between values of "x" column of <a href='meta.html'>"x_tbl" metadata</a>) on their <a href='meta.html'>support</a>:</p><ul>
<li><p>Retyping from "continuous" to <code>type</code> "discrete" is done by computing "x"
values as centers of interval masses with probabilities equal to interval
total probabilities.</p></li>
<li><p>Retyping from "discrete" to <code>type</code> "continuous" is made approximately by
trying to compute "x" grid, for which "x" values of input distribution are
going to be centers of mass. Algorithm is approximate and might result into a
big errors in case of small number of "x" values or if they are not
"suitable" for this kind of transformation.</p></li>
</ul>

<p>Method "dirac" is used mostly for converting from "discrete" to "continuous"
type (for example, in <code><a href='form_mix.html'>form_mix()</a></code> in case different types of input
pdqr-functions). It works in the following way:</p><ul>
<li><p>Retyping from "continuous" to <code>type</code> "discrete" works only if "x_tbl"
metadata represents a mixture of dirac-like distributions. In that case it is
transformed to have "x" values from centers of those dirac-like distributions
with corresponding probabilities.</p></li>
<li><p>Retyping from "discrete" to <code>type</code> "continuous" works by transforming each
"x" value from "x_tbl" metadata into dirac-like distribution with total
probability taken from corresponding value of "prob" column. Output
essentially represents a mixture of dirac-like distributions.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='form_regrid.html'>form_regrid()</a></code> for changing grid (rows of "x_tbl" metadata) of
pdqr-function.</p>
<p><code><a href='form_resupport.html'>form_resupport()</a></code> for changing support of pdqr-function.</p>
<p>Other form functions: 
<code><a href='form_estimate.html'>form_estimate</a>()</code>,
<code><a href='form_mix.html'>form_mix</a>()</code>,
<code><a href='form_regrid.html'>form_regrid</a>()</code>,
<code><a href='form_resupport.html'>form_resupport</a>()</code>,
<code><a href='form_smooth.html'>form_smooth</a>()</code>,
<code><a href='form_tails.html'>form_tails</a>()</code>,
<code><a href='form_trans.html'>form_trans</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><code class = "r"><div class='input'><span class='va'>my_con</span> <span class='op'>&lt;-</span> <span class='fu'><a href='new_p.html'>new_d</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>2</span>, <span class='fl'>1</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>9</span><span class='op'>)</span>, <span class='st'>"continuous"</span><span class='op'>)</span>
<span class='fu'><a href='meta.html'>meta_x_tbl</a></span><span class='op'>(</span><span class='va'>my_con</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   x     y cumprob
#&gt; 1 1 0.125  0.0000
#&gt; 2 2 0.250  0.1875
#&gt; 3 3 0.375  0.5000
#&gt; 4 4 0.250  0.8125
#&gt; 5 5 0.125  1.0000</div><div class='input'>
<span class='co'># By default, conversion is done to the opposite type</span>
<span class='va'>my_dis</span> <span class='op'>&lt;-</span> <span class='fu'>form_retype</span><span class='op'>(</span><span class='va'>my_con</span><span class='op'>)</span>
<span class='fu'><a href='meta.html'>meta_x_tbl</a></span><span class='op'>(</span><span class='va'>my_dis</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   x      prob   cumprob
#&gt; 1 1 0.1111111 0.1111111
#&gt; 2 2 0.2222222 0.3333333
#&gt; 3 3 0.3333333 0.6666667
#&gt; 4 4 0.2222222 0.8888889
#&gt; 5 5 0.1111111 1.0000000</div><div class='input'>
<span class='co'># Default retyping (with method "value") is accurate when doing consecutive</span>
<span class='co'># retyping</span>
<span class='va'>my_con_2</span> <span class='op'>&lt;-</span> <span class='fu'>form_retype</span><span class='op'>(</span><span class='va'>my_dis</span>, <span class='st'>"continuous"</span><span class='op'>)</span>
<span class='fu'><a href='meta.html'>meta_x_tbl</a></span><span class='op'>(</span><span class='va'>my_con_2</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   x     y cumprob
#&gt; 1 1 0.125  0.0000
#&gt; 2 2 0.250  0.1875
#&gt; 3 3 0.375  0.5000
#&gt; 4 4 0.250  0.8125
#&gt; 5 5 0.125  1.0000</div><div class='input'>
<span class='co'># Method "dirac"</span>
<span class='va'>my_dirac</span> <span class='op'>&lt;-</span> <span class='fu'>form_retype</span><span class='op'>(</span><span class='va'>my_dis</span>, <span class='st'>"continuous"</span>, method <span class='op'>=</span> <span class='st'>"dirac"</span><span class='op'>)</span>
<span class='fu'><a href='meta.html'>meta_x_tbl</a></span><span class='op'>(</span><span class='va'>my_dirac</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    x        y    cumprob
#&gt; 1  1        0 0.00000000
#&gt; 2  1 11111111 0.05555556
#&gt; 3  1        0 0.11111111
#&gt; 4  2        0 0.11111111
#&gt; 5  2 22222222 0.22222222
#&gt; 6  2        0 0.33333333
#&gt; 7  3        0 0.33333333
#&gt; 8  3 33333333 0.50000000
#&gt; 9  3        0 0.66666666
#&gt; 10 4        0 0.66666666
#&gt; 11 4 22222222 0.77777777
#&gt; 12 4        0 0.88888888
#&gt; 13 5        0 0.88888888
#&gt; 14 5 11111111 0.94444444
#&gt; 15 5        0 0.99999999</div><div class='input'>
<span class='co'># Method "piecelin"</span>
<span class='co'>## From "continuous" to "discrete" (preferred direction)</span>
<span class='va'>my_dis_piece</span> <span class='op'>&lt;-</span> <span class='fu'>form_retype</span><span class='op'>(</span><span class='va'>my_con</span>, <span class='st'>"discrete"</span>, method <span class='op'>=</span> <span class='st'>"piecelin"</span><span class='op'>)</span>
<span class='fu'><a href='meta.html'>meta_x_tbl</a></span><span class='op'>(</span><span class='va'>my_dis_piece</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          x   prob cumprob
#&gt; 1 1.555556 0.1875  0.1875
#&gt; 2 2.533333 0.3125  0.5000
#&gt; 3 3.466667 0.3125  0.8125
#&gt; 4 4.444444 0.1875  1.0000</div><div class='input'><span class='co'>## Conversion from "discrete" to "continuous" is very approximate</span>
<span class='va'>my_con_piece</span> <span class='op'>&lt;-</span> <span class='fu'>form_retype</span><span class='op'>(</span><span class='va'>my_dis_piece</span>, <span class='st'>"continuous"</span>, method <span class='op'>=</span> <span class='st'>"piecelin"</span><span class='op'>)</span>
<span class='fu'><a href='meta.html'>meta_x_tbl</a></span><span class='op'>(</span><span class='va'>my_con_piece</span><span class='op'>)</span>
</div><div class='output co'>#&gt;           x         y cumprob
#&gt; 1 0.8444444 0.1237113     0.0
#&gt; 2 1.9222222 0.2474227     0.2
#&gt; 3 3.0000000 0.3092784     0.5
#&gt; 4 4.0777778 0.2474227     0.8
#&gt; 5 5.1555556 0.1237113     1.0</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>my_con</span>, main <span class='op'>=</span> <span class='st'>'Approximate nature of method "piecelin"'</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>my_con_piece</span>, col <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span>
</div><div class='img'><img src='form_retype-1.png' alt='' width='700' height='433' /></div></code></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Evgeni Chasnovski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


