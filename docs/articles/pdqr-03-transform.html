<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Transform pdqr-functions with `form_*()` and base operations • pdqr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="Transform pdqr-functions with `form_*()` and base operations">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pdqr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pdqr-01-create.html">Create pdqr-functions with `new_*()`</a>
    </li>
    <li>
      <a href="../articles/pdqr-02-convert.html">Convert pdqr-functions with `as_*()`</a>
    </li>
    <li>
      <a href="../articles/pdqr-03-transform.html">Transform pdqr-functions with `form_*()` and base operations</a>
    </li>
    <li>
      <a href="../articles/pdqr-04-summarize.html">Summarize pdqr-functions with `summ_*()`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/echasnovski/pdqr">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Transform pdqr-functions with <code>form_*()</code> and base operations</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/echasnovski/pdqr/blob/master/vignettes/pdqr-03-transform.Rmd"><code>vignettes/pdqr-03-transform.Rmd</code></a></small>
      <div class="hidden name"><code>pdqr-03-transform.Rmd</code></div>

    </div>

    
    
<p>Concept of form functions is to take one or more pdqr-function(s) and return a transformed pdqr-function. Argument <code>method</code> is used to choose function-specific algorithm of computation.</p>
<p>Transformation of pdqr-functions can be done with <code>form_*()</code> family or with base R operators (implemented with <a href="https://rdrr.io/r/base/groupGeneric.html">S3 group generic functions</a>).</p>
<div id="form_-family" class="section level2">
<h2 class="hasAnchor">
<a href="#form_-family" class="anchor"></a><code>form_*()</code> family</h2>
<p>There are several <code>form_*()</code> functions. Here are some important examples. For more information, please, browse documentation.</p>
<div id="form_trans" class="section level3">
<h3 class="hasAnchor">
<a href="#form_trans" class="anchor"></a><code>form_trans()</code>
</h3>
<p><code><a href="../reference/form_trans.html">form_trans()</a></code> performs a transformation of input pdqr-function(s) (assumed to represent independent distributions). Default method is “random” which works based on random simulation: generates sample(s) from input pdqr-function(s), calls transformation function on them, and creates output pdqr-function based on transformation output.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Transformation function should be vectorized</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">trans_fun &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {<span class="kw"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span>(x <span class="op">*</span><span class="st"> </span>y)}</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">d_norm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/as-pdqr.html">as_d</a></span>(dnorm)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">d_unif &lt;-<span class="st"> </span><span class="kw"><a href="../reference/as-pdqr.html">as_d</a></span>(dunif)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co"># Output's support has values outside of [-1; 1] interval, which is impossible</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co"># with `sin()` function. This is because of "extending property" of `density()`.</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">(d_transformed &lt;-<span class="st"> </span><span class="kw"><a href="../reference/form_trans.html">form_trans</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(d_norm, d_unif), <span class="dt">trans =</span> trans_fun))</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt; Density function of continuous type</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; Support: ~[-1.162, 1.162] (511 intervals)</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co"># One way of dealing with this is to set `cut = 0` as argument for `density()`</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co"># which is called in `new_*()`. The other way is to use `form_resupport()`.</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14">(d_transformed_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/form_trans.html">form_trans</a></span>(</a>
<a class="sourceLine" id="cb1-15" data-line-number="15">  <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(d_norm, d_unif), <span class="dt">trans =</span> trans_fun,</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">  <span class="dt">args_new =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">cut =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">))</a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt; Density function of continuous type</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt; Support: ~[-1, 1] (511 intervals)</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(d_transformed, <span class="dt">col =</span> <span class="st">"black"</span>, <span class="dt">main =</span> <span class="st">"Transformations of distribution"</span>)</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">  <span class="co"># `d_transformed_2()` differs slightly because of randomness involved</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(d_transformed_<span class="dv">2</span>, <span class="dt">col =</span> <span class="st">"blue"</span>)</a></code></pre></div>
<p><img src="pdqr-03-transform_files/figure-html/form_trans_random-1.png" width="700"></p>
<p>The other method is “bruteforce”, which converts input function(s) to have type “discrete”, applies function to all possible combinations of output values, creates pdqr-function based on output, and possibly converts back to “continuous” type. This method is <strong>very time consuming</strong> and might be useful only when applied to “discrete” functions with not many combinations of “x” values.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">d_binom &lt;-<span class="st"> </span><span class="kw"><a href="../reference/as-pdqr.html">as_d</a></span>(dbinom, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">prob =</span> <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">(d_binom_transformed &lt;-<span class="st"> </span><span class="kw"><a href="../reference/form_trans.html">form_trans</a></span>(</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(d_binom, d_binom), <span class="dt">trans =</span> trans_fun, <span class="dt">method =</span> <span class="st">"bruteforce"</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">))</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; Probability mass function of discrete type</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; Support: ~[-0.99389, 0.99061] (43 elements)</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw"><a href="../reference/meta.html">meta_x_tbl</a></span>(d_binom_transformed))</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt;            x         prob      cumprob</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; 1 -0.9938887 1.708524e-08 1.708524e-08</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; 2 -0.9917789 1.406216e-03 1.406233e-03</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; 3 -0.9880316 7.569145e-03 8.975378e-03</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; 4 -0.9589243 2.491900e-02 3.389438e-02</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; 5 -0.9537527 8.103046e-05 3.397541e-02</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; 6 -0.9165215 6.617487e-04 3.463716e-02</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co"># Compare "bruteforce" output to "random" output</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18">d_binom_transformed_random &lt;-<span class="st"> </span><span class="kw"><a href="../reference/form_trans.html">form_trans</a></span>(</a>
<a class="sourceLine" id="cb2-19" data-line-number="19">  <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(d_binom, d_binom), <span class="dt">trans =</span> trans_fun, <span class="dt">method =</span> <span class="st">"random"</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20">)</a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw"><a href="../reference/meta.html">meta_x_tbl</a></span>(d_binom_transformed_random))</a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt;            x   prob cumprob</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt; 1 -0.9917789 0.0017  0.0017</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt; 2 -0.9880316 0.0082  0.0099</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co">#&gt; 3 -0.9589243 0.0240  0.0339</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co">#&gt; 4 -0.9537527 0.0002  0.0341</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="co">#&gt; 5 -0.9165215 0.0005  0.0346</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">#&gt; 6 -0.9055784 0.0140  0.0486</span></a></code></pre></div>
</div>
<div id="form_resupport-and-form_tails" class="section level3">
<h3 class="hasAnchor">
<a href="#form_resupport-and-form_tails" class="anchor"></a><code>form_resupport()</code> and <code>form_tails()</code>
</h3>
<p><code><a href="../reference/form_resupport.html">form_resupport()</a></code> transforms distribution to have support predefined by one or both edges. This might be useful when dealing with “extending property” of <code><a href="https://rdrr.io/r/stats/density.html">density()</a></code> function in case of known value boundaries (for which default method “reflect” suits best). Continuing previous section:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  d_transformed, <span class="dt">col =</span> <span class="st">"black"</span>,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  <span class="dt">main =</span> <span class="st">"Different methods of `form_resupport()`"</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co"># Reflect density tails outside of desired support to be inside</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  <span class="kw"><a href="../reference/form_resupport.html">form_resupport</a></span>(d_transformed, <span class="dt">support =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">method =</span> <span class="st">"reflect"</span>),</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  <span class="dt">col =</span> <span class="st">"blue"</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co"># Remove those tails while renormalizing density</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">  <span class="kw"><a href="../reference/form_resupport.html">form_resupport</a></span>(d_transformed, <span class="dt">support =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">method =</span> <span class="st">"trim"</span>),</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">  <span class="dt">col =</span> <span class="st">"red"</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16">)</a>
<a class="sourceLine" id="cb3-17" data-line-number="17"></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co"># Concentrate those tails on edges of desired support</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(</a>
<a class="sourceLine" id="cb3-20" data-line-number="20">  <span class="kw"><a href="../reference/form_resupport.html">form_resupport</a></span>(d_transformed, <span class="dt">support =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">method =</span> <span class="st">"winsor"</span>),</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">  <span class="dt">col =</span> <span class="st">"green"</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22">)</a>
<a class="sourceLine" id="cb3-23" data-line-number="23"></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co"># Warp support linear to be desired support</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(</a>
<a class="sourceLine" id="cb3-26" data-line-number="26">  <span class="kw"><a href="../reference/form_resupport.html">form_resupport</a></span>(d_transformed, <span class="dt">support =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">method =</span> <span class="st">"linear"</span>),</a>
<a class="sourceLine" id="cb3-27" data-line-number="27">  <span class="dt">col =</span> <span class="st">"magenta"</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28">)</a></code></pre></div>
<p><img src="pdqr-03-transform_files/figure-html/form_resupport-1.png" width="700"></p>
<p><code><a href="../reference/form_tails.html">form_tails()</a></code> also modifies support of input distribution by removing its tail(s). Removed amount is defined by <code>level</code> - total probability of tail. This function is useful for computing robust versions of distributions.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(d_norm, <span class="dt">col =</span> <span class="st">"black"</span>, <span class="dt">main =</span> <span class="st">"Different methods of `form_tails()`"</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co"># Remove tail(s) completely with `method = "trim"`. By default, tails from both</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co"># sides are removed</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw"><a href="../reference/form_tails.html">form_tails</a></span>(d_norm, <span class="dt">level =</span> <span class="fl">0.05</span>, <span class="dt">method =</span> <span class="st">"trim"</span>), <span class="dt">col =</span> <span class="st">"blue"</span>)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co"># Concentrate probability on edge(s) with `method = "winsor"`</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">  <span class="kw"><a href="../reference/form_tails.html">form_tails</a></span>(d_norm, <span class="dt">level =</span> <span class="fl">0.1</span>, <span class="dt">method =</span> <span class="st">"winsor"</span>, <span class="dt">direction =</span> <span class="st">"right"</span>),</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">  <span class="dt">col =</span> <span class="st">"red"</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">)</a></code></pre></div>
<p><img src="pdqr-03-transform_files/figure-html/form_tails-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co"># Use `form_resupport()` and `as_q()` to remove different levels from both</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co"># directions. Here 0.1 level tail from left is removed, and 0.05 level from</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co"># right</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">new_supp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/as-pdqr.html">as_q</a></span>(d_norm)(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="dv">1</span><span class="fl">-0.05</span>))</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="kw"><a href="../reference/form_resupport.html">form_resupport</a></span>(d_norm, <span class="dt">support =</span> new_supp, <span class="dt">method =</span> <span class="st">"trim"</span>)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; Density function of continuous type</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; Support: ~[-1.28155, 1.64485] (3080 intervals)</span></a></code></pre></div>
</div>
<div id="form_recenter-and-form_respread" class="section level3">
<h3 class="hasAnchor">
<a href="#form_recenter-and-form_respread" class="anchor"></a><code>form_recenter()</code> and <code>form_respread()</code>
</h3>
<p>During hypothesis testing there is usually a need to alter some existing distribution to have certain center and/or spread. Functions <code><a href="../reference/form_recenter.html">form_recenter()</a></code> and <code><a href="../reference/form_recenter.html">form_respread()</a></code> implement linear transformations that accomplish this goal:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">my_beta &lt;-<span class="st"> </span><span class="kw"><a href="../reference/as-pdqr.html">as_d</a></span>(dbeta, <span class="dt">shape1 =</span> <span class="dv">1</span>, <span class="dt">shape2 =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co"># Distribution is shifted to the right so as to have mean (default method of</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># `summ_center()`) equal to 2</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">my_beta2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/form_recenter.html">form_recenter</a></span>(my_beta, <span class="dt">to =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="kw"><a href="../reference/summ_center.html">summ_center</a></span>(my_beta2)</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; [1] 2</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co"># Distribution is stretched around its center so as to have range equal to 10</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10">my_beta3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/form_recenter.html">form_respread</a></span>(my_beta2, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">method =</span> <span class="st">"range"</span>)</a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="kw"><a href="../reference/summ_spread.html">summ_spread</a></span>(my_beta3, <span class="dt">method =</span> <span class="st">"range"</span>)</a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13">  <span class="co"># Center remains unchainged</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="kw"><a href="../reference/summ_center.html">summ_center</a></span>(my_beta3)</a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; [1] 2</span></a></code></pre></div>
</div>
<div id="form_mix" class="section level3">
<h3 class="hasAnchor">
<a href="#form_mix" class="anchor"></a><code>form_mix()</code>
</h3>
<p><code><a href="../reference/form_mix.html">form_mix()</a></code> results into mixture of distributions. Input can have both types of pdqr-functions. Output will be “discrete” only if all inputs have “discrete” type. If at least one input pdqr-function has “continuous” type, all possible “discrete” inputs are converted to be “continuous” type (with <code><a href="../reference/form_retype.html">form_retype()</a></code> and method “dirac”) in form of mixture of dirac-like “continuous” functions. <strong>Note</strong> that output can have many piecewise-linear intervals, and to reduce their amount (with possible accuracy loss) use <code><a href="../reference/form_regrid.html">form_regrid()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># All inputs have the same type</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">dis_list &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="kw"><a href="../reference/as-pdqr.html">as_d</a></span>(dbinom, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">prob =</span> <span class="fl">0.3</span>),</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  <span class="kw"><a href="../reference/as-pdqr.html">as_d</a></span>(dpois, <span class="dt">lambda =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="../reference/form_mix.html">form_mix</a></span>(dis_list), <span class="dt">main =</span> <span class="st">"Mixture of binomial and Poisson"</span>)</a></code></pre></div>
<p><img src="pdqr-03-transform_files/figure-html/form_mix-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">norm_list &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="../reference/as-pdqr.html">as_d</a></span>(dnorm), <span class="kw"><a href="../reference/as-pdqr.html">as_d</a></span>(dnorm, <span class="dt">mean =</span> <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  <span class="kw"><a href="../reference/form_mix.html">form_mix</a></span>(norm_list, <span class="dt">weights =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>)),</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">  <span class="dt">main =</span> <span class="st">"Mixture of normal distributions"</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">)</a></code></pre></div>
<p><img src="pdqr-03-transform_files/figure-html/form_mix-2.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co"># Here all "discrete" pdqr-functions are converted to be "continuous" with</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co"># values represented as dirac-like density "spikes"</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">mixed_both &lt;-<span class="st"> </span><span class="kw"><a href="../reference/form_mix.html">form_mix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(norm_list, dis_list))</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(mixed_both, <span class="dt">main =</span> <span class="st">'Density of mixture of "discrete" and "continuous"'</span>)</a></code></pre></div>
<p><img src="pdqr-03-transform_files/figure-html/form_mix-3.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="../reference/as-pdqr.html">as_p</a></span>(mixed_both), <span class="dt">main =</span> <span class="st">'CDF of mixture of "discrete" and "continuous"'</span>)</a></code></pre></div>
<p><img src="pdqr-03-transform_files/figure-html/form_mix-4.png" width="700"></p>
</div>
<div id="form_estimate" class="section level3">
<h3 class="hasAnchor">
<a href="#form_estimate" class="anchor"></a><code>form_estimate()</code>
</h3>
<p><code><a href="../reference/form_estimate.html">form_estimate()</a></code> computes distribution of sample estimate. For example, what distribution would have mean of 20 sample elements from uniform distribution? To answer this question, <code><a href="../reference/form_estimate.html">form_estimate()</a></code> would use simulation. One randomly generate element from target distribution is achieved by generating 20 elements from input one and computing desired statistic. This is repeated many times with calling one of <code>new_*()</code> functions on resulted sample from target distribution. <strong>Note</strong> that this algorithm usually quite time consuming.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">(unif_mean &lt;-<span class="st"> </span><span class="kw"><a href="../reference/form_estimate.html">form_estimate</a></span>(d_unif, <span class="dt">stat =</span> mean, <span class="dt">sample_size =</span> <span class="dv">20</span>))</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt; Density function of continuous type</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt; Support: ~[0.22168, 0.75006] (511 intervals)</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  unif_mean, <span class="dt">main =</span> <span class="st">"Distribution of mean statistic for 20 elements of uniform"</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7"></a>
<a class="sourceLine" id="cb11-8" data-line-number="8">  <span class="co"># Approximated normal output</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw"><a href="../reference/as-pdqr.html">as_d</a></span>(dnorm, <span class="dt">mean =</span> <span class="fl">0.5</span>, <span class="dt">sd =</span> <span class="dv">1</span><span class="op">/</span><span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="dv">12</span><span class="op">*</span><span class="dv">20</span>)), <span class="dt">col =</span> <span class="st">"red"</span>)</a></code></pre></div>
<p><img src="pdqr-03-transform_files/figure-html/form_estimate-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co"># Estimation of 75% quantile. Here once again one can see the "extending</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co"># property" of `density()` function used in `new_*()`, because right edge of</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co"># support is more than 1, which is impossible.</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5">(unif_quan &lt;-<span class="st"> </span><span class="kw"><a href="../reference/form_estimate.html">form_estimate</a></span>(</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">  d_unif, <span class="dt">stat =</span> quantile, <span class="dt">sample_size =</span> <span class="dv">20</span>, <span class="dt">probs =</span> <span class="fl">0.75</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7">))</a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt; Density function of continuous type</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; Support: ~[0.25579, 1.01289] (511 intervals)</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(</a>
<a class="sourceLine" id="cb12-11" data-line-number="11">  unif_quan,</a>
<a class="sourceLine" id="cb12-12" data-line-number="12">  <span class="dt">main =</span> <span class="st">"Distribution of 75% quantile statistic for 20 elements of uniform"</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13">)</a>
<a class="sourceLine" id="cb12-14" data-line-number="14"></a>
<a class="sourceLine" id="cb12-15" data-line-number="15">  <span class="co"># "Correct" distribution of 15th order statistic of the uniform distribution</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16">  <span class="co"># with sample size 20</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="kw"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span>(<span class="kw"><a href="../reference/as-pdqr.html">as_d</a></span>(dbeta, <span class="dt">shape1 =</span> <span class="dv">15</span>, <span class="dt">shape2 =</span> <span class="dv">6</span>), <span class="dt">col =</span> <span class="st">"red"</span>)</a></code></pre></div>
<p><img src="pdqr-03-transform_files/figure-html/form_estimate-2.png" width="700"></p>
</div>
</div>
<div id="base-operations" class="section level2">
<h2 class="hasAnchor">
<a href="#base-operations" class="anchor"></a>Base operations</h2>
<p>Almost all basic R operations (implemented with <a href="https://rdrr.io/r/base/groupGeneric.html">S3 group generic functions</a>) has methods for pdqr-functions. Operations are done as if applied to independent random variables with distributions represented by input pdqr-function(s). Many of methods have random nature and are implemented with <code><a href="../reference/form_trans.html">form_trans()</a></code>, but have little tweaks that make their direct usage better than <code><a href="../reference/form_trans.html">form_trans()</a></code>.</p>
<p>Methods for <code>Math</code> are mostly implemented with simulation:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># Exponent of uniform distribution</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(d_unif)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt; Density function of continuous type</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; Support: ~[1, 2.71828] (515 intervals)</span></a></code></pre></div>
<p>Methods for <code>Ops</code> may be divided into two parts:</p>
<ul>
<li>Mathematical operations: “+”, “-”, "*“,”/“,”^“,”%%“,”%/%". They are implemented with simulation.</li>
<li>Logical operations: all other. They are <strong>implemented directly</strong> and can be very useful when doing comparison statistical inference. Their output is boolean pdqr-function (type “discrete” with values 0 for FALSE and 1 for TRUE). To extract probability from this type of functions, use <code><a href="../reference/summ_prob_true.html">summ_prob_true()</a></code> and <code><a href="../reference/summ_prob_true.html">summ_prob_false()</a></code>.</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># Distribution of used in `form_trans()` section transformation function. Note</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co"># the correct support [-1, 1] without effect of "extending property" of</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co"># `density()`. Here the default method of `form_resupport()` is used.</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span>(d_norm <span class="op">*</span><span class="st"> </span>d_unif)</a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; Density function of continuous type</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; Support: [-1, 1] (515 intervals)</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co"># Comparing random variables results into boolean random variable represented</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co"># by boolean pdqr-function.</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co"># Here it means that random value of `d_norm` will be greater than random value</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co"># of `d_unif` with probability around 0.316.</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12">d_norm <span class="op">&gt;</span><span class="st"> </span>d_unif</a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt; Probability mass function of discrete type</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; Support: [0, 1] (2 elements, probability of 1: ~0.31563)</span></a></code></pre></div>
<p>Methods for <code>Summary</code> may also be divided into conceptually the same parts as in <code>Ops</code>:</p>
<ul>
<li>Mathematical operations: <code>sum</code>, <code>prod</code>, <code>min</code>, <code>max</code>. They are implemented with simulation.</li>
<li>Logical operations: <code>all</code>, <code>any</code>. Implemented directly. They are most useful when all input pdqr-functions are boolean.</li>
</ul>
<p>Function <code><a href="https://rdrr.io/r/base/range.html">range()</a></code> doesn’t make sense in this setup because it returns two numbers instead of one.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># Distribution of maximum of three random variables</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(d_norm, d_norm, d_norm)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#&gt; Density function of continuous type</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">#&gt; Support: ~[-2.34473, 4.46546] (511 intervals)</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co"># Probability that all inequalities are true</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="kw"><a href="../reference/summ_prob_true.html">summ_prob_true</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/all.html">all</a></span>(d_norm <span class="op">&gt;</span><span class="st"> </span>d_unif, d_norm <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>d_unif))</a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co">#&gt; [1] 0.06161823</span></a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li class="toc-lev1">
<a href="#form_-family"><code>form_*()</code> family</a><ul class="nav nav-pills nav-stacked">
<li class="toc-lev2"><a href="#form_trans"><code>form_trans()</code></a></li>
      <li class="toc-lev2"><a href="#form_resupport-and-form_tails"><code>form_resupport()</code> and <code>form_tails()</code></a></li>
      <li class="toc-lev2"><a href="#form_recenter-and-form_respread"><code>form_recenter()</code> and <code>form_respread()</code></a></li>
      <li class="toc-lev2"><a href="#form_mix"><code>form_mix()</code></a></li>
      <li class="toc-lev2"><a href="#form_estimate"><code>form_estimate()</code></a></li>
      </ul>
</li>
      <li class="toc-lev1"><a href="#base-operations">Base operations</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Evgeni Chasnovski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
